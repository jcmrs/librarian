name: Jules (The Backroom Builder)

on:
  issues: [opened, edited]
  issue_comment: [created]

permissions:
  contents: write
  issues: write
  pull-requests: write

jobs:
  jules_execute:
    if: contains(github.event.issue.body, '@Jules')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v4
        with: {python-version: '3.11'}
      - run: pip install -r ai_ops/requirements.txt
      - env:
          LLM_API_KEY: ${{ secrets.LLM_API_KEY }}
          LLM_MODEL: "gemini/gemini-2.5-flash"
          LLM_PROVIDER: "gemini"
          GRAPH_DATABASE_PROVIDER: "networkx"
          VECTOR_DATABASE_PROVIDER: "lancedb"
          RELATIONAL_DATABASE_PROVIDER: "sqlite"
          COGNEE_ROOT_DIR: "./.cognee_memory"
        run: python ai_ops/librarian.py --index .
      - env:
          ISSUE_BODY: ${{ github.event.issue.body }}
        run: echo "Jules Online. Task Received."
